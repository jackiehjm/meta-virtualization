From 0329033db9a1d0954c304f209ea88824e8f78b8a Mon Sep 17 00:00:00 2001
From: Jake Omann <jomann@nagios.com>
Date: Wed, 19 Dec 2018 11:36:12 -0600
Subject: [PATCH] Fixed XSS vulnerability in Alert Summary report
 (CVE-2018-18245)

CVE: CVE-2018-18245
Upstream-Status: Backport[master]
https://github.com/NagiosEnterprises/nagioscore/commit/0329033db9a1d0954c304f209ea88824e8f78b8a

Signed-off-by: Yue Tao <yue.tao@windriver.com>
---
 Changelog     |    1 +
 cgi/summary.c |    2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/cgi/summary.c b/cgi/summary.c
index b732b3b..63846c6 100644
--- a/cgi/summary.c
+++ b/cgi/summary.c
@@ -1785,7 +1785,7 @@ void display_recent_alerts(void) {
 
 		printf("<td CLASS='data%s'>%s</td>", bgclass, (temp_event->state_type == AE_SOFT_STATE) ? "SOFT" : "HARD");
 
-		printf("<td CLASS='data%s'>%s</td>", bgclass, temp_event->event_info);
+		printf("<td CLASS='data%s'>%s</td>", bgclass, html_encode(temp_event->event_info, 1));
 
 		printf("</tr>\n");
 		}
-- 
1.7.9.5

